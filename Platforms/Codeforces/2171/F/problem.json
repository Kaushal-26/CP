{
  "batch": {
    "id": "1e3e5b93-959a-4b74-8b62-cd985f0107bd",
    "size": 9
  },
  "createdAt": "2025-11-20T20:06:05+05:30",
  "group": "Codeforces - Codeforces Round 1065 (Div. 3)",
  "input": {
    "type": "stdin"
  },
  "languages": {
    "java": {
      "mainClass": "Main",
      "taskClass": "FRaeTaylorAndTreesHardVersion"
    }
  },
  "memoryLimit": 256,
  "name": "F. Rae Taylor and Trees (hard version)",
  "output": {
    "type": "stdout"
  },
  "testType": "single",
  "tests": [
    {
      "input": "9\n6\n1 3 4 5 2 6\n4\n3 4 1 2\n5\n4 3 5 1 2\n4\n1 2 3 4\n7\n4 3 5 7 6 2 1\n6\n2 4 6 1 3 5\n3\n2 1 3\n4\n2 4 1 3\n6\n4 2 6 5 1 3\n",
      "output": "Yes\n3 1\n4 1\n6 5\n6 2\n6 1\nNo\nNo\nYes\n2 1\n4 3\n4 1\nNo\nYes\n4 2\n6 2\n3 1\n5 1\n5 2\nYes\n3 2\n3 1\nYes\n4 2\n3 1\n3 2\nYes\n6 4\n6 2\n3 1\n5 4\n2 3\n"
    }
  ],
  "timeLimit": 3000,
  "url": "https://codeforces.com/contest/2171/problem/F"
}